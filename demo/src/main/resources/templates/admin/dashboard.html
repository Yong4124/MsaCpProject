<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{admin/layout :: head('관리자 대시보드')}"></head>
<body>
<nav th:replace="~{admin/layout :: sidebar}"></nav>

<div class="admin-content">
    <div th:replace="~{admin/layout :: topbar('대시보드')}"></div>
    
    <main class="admin-main">
        <!-- 통계 카드 -->
        <div class="row g-4 mb-4">
            <div class="col-md-6 col-lg-3">
                <div class="card stat-card">
                    <div class="card-body d-flex align-items-center">
                        <div class="stat-icon bg-primary bg-opacity-10 text-primary me-3">
                            <i class="bi bi-person"></i>
                        </div>
                        <div>
                            <h3 class="mb-0" th:text="${totalPersonal}">0</h3>
                            <small class="text-muted">개인회원</small>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="card stat-card">
                    <div class="card-body d-flex align-items-center">
                        <div class="stat-icon bg-success bg-opacity-10 text-success me-3">
                            <i class="bi bi-building"></i>
                        </div>
                        <div>
                            <h3 class="mb-0" th:text="${totalCompany}">0</h3>
                            <small class="text-muted">기업회원</small>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="card stat-card">
                    <div class="card-body d-flex align-items-center">
                        <div class="stat-icon bg-info bg-opacity-10 text-info me-3">
                            <i class="bi bi-briefcase"></i>
                        </div>
                        <div>
                            <h3 class="mb-0" th:text="${totalJobs}">0</h3>
                            <small class="text-muted">채용공고</small>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="card stat-card">
                    <div class="card-body d-flex align-items-center">
                        <div class="stat-icon bg-warning bg-opacity-10 text-warning me-3">
                            <i class="bi bi-hourglass-split"></i>
                        </div>
                        <div>
                            <h3 class="mb-0" th:text="${pendingPersonal + pendingCompany}">0</h3>
                            <small class="text-muted">승인 대기</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 승인 대기 알림 -->
        <div class="alert alert-warning d-flex align-items-center mb-4" th:if="${pendingPersonal + pendingCompany > 0}">
            <i class="bi bi-exclamation-triangle-fill me-2"></i>
            <div>
                승인 대기 중인 회원이 있습니다: 
                <a th:href="@{/admin/members/personal(status='pending')}" th:if="${pendingPersonal > 0}">
                    개인회원 <span th:text="${pendingPersonal}">0</span>명
                </a>
                <span th:if="${pendingPersonal > 0 && pendingCompany > 0}">, </span>
                <a th:href="@{/admin/members/company(status='pending')}" th:if="${pendingCompany > 0}">
                    기업회원 <span th:text="${pendingCompany}">0</span>명
                </a>
            </div>
        </div>
        
        <div class="row g-4">
            <!-- 최근 개인회원 -->
            <div class="col-lg-6">
                <div class="card admin-table">
                    <div class="card-header bg-white d-flex justify-content-between align-items-center py-3">
                        <h5 class="mb-0"><i class="bi bi-person me-2 text-primary"></i>최근 개인회원</h5>
                        <a th:href="@{/admin/members/personal}" class="btn btn-sm btn-outline-primary">전체보기</a>
                    </div>
                    <div class="card-body p-0">
                        <table class="table table-hover mb-0" th:if="${not #lists.isEmpty(recentPersonal)}">
                            <thead>
                                <tr>
                                    <th>이름</th>
                                    <th>이메일</th>
                                    <th>상태</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr th:each="member : ${recentPersonal}">
                                    <td th:text="${member.firstName + ' ' + member.lastName}">이름</td>
                                    <td th:text="${member.email}">이메일</td>
                                    <td>
                                        <span class="badge bg-success" th:if="${member.approvalYn == 'Y'}">승인</span>
                                        <span class="badge bg-warning" th:if="${member.approvalYn == 'N'}">대기</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="text-center text-muted py-4" th:if="${#lists.isEmpty(recentPersonal)}">
                            등록된 회원이 없습니다.
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 최근 기업회원 -->
            <div class="col-lg-6">
                <div class="card admin-table">
                    <div class="card-header bg-white d-flex justify-content-between align-items-center py-3">
                        <h5 class="mb-0"><i class="bi bi-building me-2 text-success"></i>최근 기업회원</h5>
                        <a th:href="@{/admin/members/company}" class="btn btn-sm btn-outline-success">전체보기</a>
                    </div>
                    <div class="card-body p-0">
                        <table class="table table-hover mb-0" th:if="${not #lists.isEmpty(recentCompany)}">
                            <thead>
                                <tr>
                                    <th>회사명</th>
                                    <th>담당자</th>
                                    <th>상태</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr th:each="member : ${recentCompany}">
                                    <td th:text="${member.company}">회사명</td>
                                    <td th:text="${member.managerName}">담당자</td>
                                    <td>
                                        <span class="badge bg-success" th:if="${member.approvalYn == 'Y'}">승인</span>
                                        <span class="badge bg-warning" th:if="${member.approvalYn == 'N'}">대기</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="text-center text-muted py-4" th:if="${#lists.isEmpty(recentCompany)}">
                            등록된 기업이 없습니다.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>

<th:block th:replace="~{admin/layout :: scripts}"></th:block>
</body>
</html>
